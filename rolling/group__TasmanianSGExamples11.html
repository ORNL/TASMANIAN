<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Toolkit for Adaptive Stochastic Modeling and Non-Intrusive ApproximatioN: Tasmanian v8.2: Tasmanian Sparse Grids module, example 11</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="tasmanian.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
    <div class="doxygen">
            <a href="http://www.doxygen.org/index.html">
                Doxygen
                </a> 1.9.8
    </div>
   <div id="projectname">Toolkit for Adaptive Stochastic Modeling and Non-Intrusive ApproximatioN: Tasmanian v8.2
           <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__TasmanianSGExamples11.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Tasmanian Sparse Grids module, example 11<div class="ingroups"><a class="el" href="group__TasmanianSGExamples.html">Examples for the Tasmanian Sparse Grid module</a></div></div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Tasmanian Sparse Grids module, example 11:</div>
<div class="dyncontent">
<div class="center"><img src="group__TasmanianSGExamples11.png" border="0" usemap="#agroup____TasmanianSGExamples11" alt=""/></div>
<map name="agroup____TasmanianSGExamples11" id="agroup____TasmanianSGExamples11">
<area shape="rect" href="group__TasmanianSGExamples.html" title=" " alt="" coords="5,5,193,45"/>
<area shape="rect" title=" " alt="" coords="241,5,407,45"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga09f861b7d648c78a4e34860ed0b6537f" id="r_ga09f861b7d648c78a4e34860ed0b6537f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TasmanianSGExamples11.html#ga09f861b7d648c78a4e34860ed0b6537f">sparse_grids_example_11</a> ()</td></tr>
<tr class="memdesc:ga09f861b7d648c78a4e34860ed0b6537f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sparse Grids Example 11: Unstructured data.  <br /></td></tr>
<tr class="separator:ga09f861b7d648c78a4e34860ed0b6537f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section user"><dt>Example 11</dt><dd>Constructing a grid from unstructured data. </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga09f861b7d648c78a4e34860ed0b6537f" name="ga09f861b7d648c78a4e34860ed0b6537f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga09f861b7d648c78a4e34860ed0b6537f">&#9670;&#160;</a></span>sparse_grids_example_11()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sparse_grids_example_11 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sparse Grids Example 11: Unstructured data. </p>
<p>Sparse grid approximation (or surrogates) can be constructed from a set of points not necessarily aligned to the points on the grid, using a least-squares fit.</p><ul>
<li>the fit will not interpolate the data, i.e., there will be a difference between the surrogate and the data at each point</li>
<li>the overall accuracy will be lower and more points are needed to reach the same accuracy as in the structured case, the fit should be used when the model cannot be sampled exactly at the sparse grid points</li>
<li>solving the fit requires the solution to a system of linear equations and uses significant amount of flops and memory, at the minimum BLAS must be enabled but GPU acceleration is preferable with the MAGMA library which provides advanced out-of-core methods</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;\n---------------------------------------------------------------------------------------------------\n&quot;</span>;</div>
<div class="line">    cout &lt;&lt; std::scientific; cout.precision(4);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Example 11: construction using unstructured data\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span> num_inputs = 2;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// using random points to test the error</span></div>
<div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span> num_test_points = 1000;</div>
<div class="line">    std::vector&lt;double&gt; test_points(num_test_points * num_inputs);</div>
<div class="line">    std::minstd_rand park_miller(42);</div>
<div class="line">    std::uniform_real_distribution&lt;double&gt; domain(-1.0, 1.0);</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;t : test_points) t = domain(park_miller);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// computes the error between the gird surrogate model and the actual model</span></div>
<div class="line">    <span class="comment">// using the test points, finds the largest absolute error</span></div>
<div class="line">    <span class="keyword">auto</span> get_error = [&amp;](<a class="code hl_class" href="classTasGrid_1_1TasmanianSparseGrid.html">TasGrid::TasmanianSparseGrid</a> <span class="keyword">const</span> &amp;grid,</div>
<div class="line">                         std::function&lt;void(<span class="keywordtype">double</span> <span class="keyword">const</span> x[], <span class="keywordtype">double</span> y[], <span class="keywordtype">size_t</span>)&gt; model)-&gt;</div>
<div class="line">        <span class="keywordtype">double</span>{</div>
<div class="line">            std::vector&lt;double&gt; grid_result;</div>
<div class="line">            grid.<a class="code hl_function" href="classTasGrid_1_1TasmanianSparseGrid.html#a7e35f5abc8315c4af97b1abb7e191d85">evaluateBatch</a>(test_points, grid_result);</div>
<div class="line">            <span class="keywordtype">double</span> err = 0.0;</div>
<div class="line">            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;num_test_points; i++){</div>
<div class="line">                <span class="keywordtype">double</span> model_result; <span class="comment">// using only one output</span></div>
<div class="line">                model(&amp;test_points[i*num_inputs], &amp;model_result, 0);</div>
<div class="line">                err = std::max(err, std::abs(grid_result[i] - model_result));</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> err;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// using a simple model</span></div>
<div class="line">    <span class="keyword">auto</span> model = [](<span class="keywordtype">double</span> <span class="keyword">const</span> x[], <span class="keywordtype">double</span> y[], size_t)-&gt;</div>
<div class="line">        <span class="keywordtype">void</span>{ y[0] = std::exp(-x[0]*x[0] -x[1]-x[1]); };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> grid = <a class="code hl_function" href="group__TasmanianSG.html#ga734013b4f52c4d1d9a35d674b459e13a">TasGrid::makeGlobalGrid</a>(num_inputs, 1, 4, <a class="code hl_enumvalue" href="group__SGEnumerates.html#gga94134756077eff395566c64e6426455fa6feeea3001da5a72dcf3602b9e3cfb0c">TasGrid::type_level</a>, <a class="code hl_enumvalue" href="group__SGEnumerates.html#gga145e27d5ae92acdd5f74149c6d4f2ca2a7979fed9357e95bf01dc3169051f9fcf">TasGrid::rule_clenshawcurtis</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// generate random data for the inputs, and compute the corresponding outputs</span></div>
<div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span> num_data_points = 2000;</div>
<div class="line">    std::vector&lt;double&gt; data_input(num_inputs * num_data_points);</div>
<div class="line">    std::vector&lt;double&gt; data_output(num_data_points);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;d : data_input) d = domain(park_miller);</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;num_data_points; i++) model(&amp;data_input[i * num_inputs], &amp;data_output[i], 0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// check if capability is available</span></div>
<div class="line">    <span class="keywordflow">if</span> (not grid.<a class="code hl_function" href="classTasGrid_1_1TasmanianSparseGrid.html#a26da7f37c10ef476605881ebc44ccb3d">isAccelerationAvailable</a>(<a class="code hl_enumvalue" href="group__SGEnumerates.html#gga344ee5be5b77f2ff8e7c98f97ab40581a4e99f4378b49ba22efd866d1eff3e689">TasGrid::accel_cpu_blas</a>) and</div>
<div class="line">        not grid.<a class="code hl_function" href="classTasGrid_1_1TasmanianSparseGrid.html#a26da7f37c10ef476605881ebc44ccb3d">isAccelerationAvailable</a>(<a class="code hl_enumvalue" href="group__SGEnumerates.html#gga344ee5be5b77f2ff8e7c98f97ab40581ace1389a7f0e1b7b9313038ea65396622">TasGrid::accel_gpu_cuda</a>) and</div>
<div class="line">        not grid.<a class="code hl_function" href="classTasGrid_1_1TasmanianSparseGrid.html#a26da7f37c10ef476605881ebc44ccb3d">isAccelerationAvailable</a>(<a class="code hl_enumvalue" href="group__SGEnumerates.html#gga344ee5be5b77f2ff8e7c98f97ab40581aac3a98fcec9c100e5422a7cd89e37269">TasGrid::accel_gpu_magma</a>)){</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Skipping example 11, BLAS, CUDA, or MAGMA acceleration required.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// accel_cpu_blas: works on the CPU and can utilize all available RAM</span></div>
<div class="line">    <span class="comment">// accel_gpu_cuda: works on the GPU but it is restricted to the case</span></div>
<div class="line">    <span class="comment">//                 where the data can fit in GPU memory</span></div>
<div class="line">    <span class="comment">// accel_gpu_magma: works out-of-core, the data is stored in CPU RAM</span></div>
<div class="line">    <span class="comment">//                  while computations are still done on the GPU</span></div>
<div class="line">    grid.<a class="code hl_function" href="classTasGrid_1_1TasmanianSparseGrid.html#ab351871503d4cb7a8287f655eefed974">enableAcceleration</a>(<a class="code hl_enumvalue" href="group__SGEnumerates.html#gga344ee5be5b77f2ff8e7c98f97ab40581aac3a98fcec9c100e5422a7cd89e37269">TasGrid::accel_gpu_magma</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// constructs the grid, depending on the amount of data data,</span></div>
<div class="line">    <span class="comment">// the side of the grid and the enabled acceleration</span></div>
<div class="line">    <span class="comment">// this can take significant amount of time</span></div>
<div class="line">    <a class="code hl_function" href="group__TasmanianAddonsLoadUnstructured.html#gaf6cc3abfc7b72c6258932ea149f11adf">TasGrid::loadUnstructuredDataL2</a>(data_input, data_output, 1.E-4, grid);</div>
<div class="line"> </div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Using construction from unstructured (random) data\n&quot;</span>;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;   approximatino error = &quot;</span> &lt;&lt; get_error(grid, model) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef __TASMANIAN_DOXYGEN_SKIP</span></div>
<div class="ttc" id="aclassTasGrid_1_1TasmanianSparseGrid_html"><div class="ttname"><a href="classTasGrid_1_1TasmanianSparseGrid.html">TasGrid::TasmanianSparseGrid</a></div><div class="ttdoc">The master-class that represents an instance of a Tasmanian sparse grid.</div><div class="ttdef"><b>Definition</b> TasmanianSparseGrid.hpp:293</div></div>
<div class="ttc" id="aclassTasGrid_1_1TasmanianSparseGrid_html_a26da7f37c10ef476605881ebc44ccb3d"><div class="ttname"><a href="classTasGrid_1_1TasmanianSparseGrid.html#a26da7f37c10ef476605881ebc44ccb3d">TasGrid::TasmanianSparseGrid::isAccelerationAvailable</a></div><div class="ttdeci">static bool isAccelerationAvailable(TypeAcceleration acc)</div><div class="ttdoc">Returns whether a specific mode can be enabled.</div></div>
<div class="ttc" id="aclassTasGrid_1_1TasmanianSparseGrid_html_a7e35f5abc8315c4af97b1abb7e191d85"><div class="ttname"><a href="classTasGrid_1_1TasmanianSparseGrid.html#a7e35f5abc8315c4af97b1abb7e191d85">TasGrid::TasmanianSparseGrid::evaluateBatch</a></div><div class="ttdeci">void evaluateBatch(std::vector&lt; FloatType &gt; const &amp;x, std::vector&lt; FloatType &gt; &amp;y) const</div><div class="ttdoc">Computes the value of the interpolant (or point-wise approximation) for a batch of points.</div></div>
<div class="ttc" id="aclassTasGrid_1_1TasmanianSparseGrid_html_ab351871503d4cb7a8287f655eefed974"><div class="ttname"><a href="classTasGrid_1_1TasmanianSparseGrid.html#ab351871503d4cb7a8287f655eefed974">TasGrid::TasmanianSparseGrid::enableAcceleration</a></div><div class="ttdeci">void enableAcceleration(TypeAcceleration acc)</div><div class="ttdoc">Change the current acceleration mode to the one specified.</div></div>
<div class="ttc" id="agroup__SGEnumerates_html_gga145e27d5ae92acdd5f74149c6d4f2ca2a7979fed9357e95bf01dc3169051f9fcf"><div class="ttname"><a href="group__SGEnumerates.html#gga145e27d5ae92acdd5f74149c6d4f2ca2a7979fed9357e95bf01dc3169051f9fcf">TasGrid::rule_clenshawcurtis</a></div><div class="ttdeci">@ rule_clenshawcurtis</div><div class="ttdoc">Classic nested rule using Chebyshev nodes with very low Lebesgue constant.</div><div class="ttdef"><b>Definition</b> tsgEnumerates.hpp:289</div></div>
<div class="ttc" id="agroup__SGEnumerates_html_gga344ee5be5b77f2ff8e7c98f97ab40581a4e99f4378b49ba22efd866d1eff3e689"><div class="ttname"><a href="group__SGEnumerates.html#gga344ee5be5b77f2ff8e7c98f97ab40581a4e99f4378b49ba22efd866d1eff3e689">TasGrid::accel_cpu_blas</a></div><div class="ttdeci">@ accel_cpu_blas</div><div class="ttdoc">Default (if available), uses both BLAS and LAPACK libraries.</div><div class="ttdef"><b>Definition</b> tsgEnumerates.hpp:555</div></div>
<div class="ttc" id="agroup__SGEnumerates_html_gga344ee5be5b77f2ff8e7c98f97ab40581aac3a98fcec9c100e5422a7cd89e37269"><div class="ttname"><a href="group__SGEnumerates.html#gga344ee5be5b77f2ff8e7c98f97ab40581aac3a98fcec9c100e5422a7cd89e37269">TasGrid::accel_gpu_magma</a></div><div class="ttdeci">@ accel_gpu_magma</div><div class="ttdoc">Same the CUDA option but uses the UTK MAGMA library for the linear algebra operations.</div><div class="ttdef"><b>Definition</b> tsgEnumerates.hpp:563</div></div>
<div class="ttc" id="agroup__SGEnumerates_html_gga344ee5be5b77f2ff8e7c98f97ab40581ace1389a7f0e1b7b9313038ea65396622"><div class="ttname"><a href="group__SGEnumerates.html#gga344ee5be5b77f2ff8e7c98f97ab40581ace1389a7f0e1b7b9313038ea65396622">TasGrid::accel_gpu_cuda</a></div><div class="ttdeci">@ accel_gpu_cuda</div><div class="ttdoc">Similar to the cuBLAS option but also uses a set of Tasmanian custom GPU kernels.</div><div class="ttdef"><b>Definition</b> tsgEnumerates.hpp:561</div></div>
<div class="ttc" id="agroup__SGEnumerates_html_gga94134756077eff395566c64e6426455fa6feeea3001da5a72dcf3602b9e3cfb0c"><div class="ttname"><a href="group__SGEnumerates.html#gga94134756077eff395566c64e6426455fa6feeea3001da5a72dcf3602b9e3cfb0c">TasGrid::type_level</a></div><div class="ttdeci">@ type_level</div><div class="ttdoc">Ignoring the polynomial space, use rules with index .</div><div class="ttdef"><b>Definition</b> tsgEnumerates.hpp:209</div></div>
<div class="ttc" id="agroup__TasmanianAddonsLoadUnstructured_html_gaf6cc3abfc7b72c6258932ea149f11adf"><div class="ttname"><a href="group__TasmanianAddonsLoadUnstructured.html#gaf6cc3abfc7b72c6258932ea149f11adf">TasGrid::loadUnstructuredDataL2</a></div><div class="ttdeci">void loadUnstructuredDataL2(double const data_points[], int num_data, double const model_values[], double tolerance, TasmanianSparseGrid &amp;grid)</div><div class="ttdoc">Construct a sparse grid surrogate using a least-squares fit.</div><div class="ttdef"><b>Definition</b> tsgLoadUnstructuredPoints.hpp:282</div></div>
<div class="ttc" id="agroup__TasmanianSG_html_ga734013b4f52c4d1d9a35d674b459e13a"><div class="ttname"><a href="group__TasmanianSG.html#ga734013b4f52c4d1d9a35d674b459e13a">TasGrid::makeGlobalGrid</a></div><div class="ttdeci">TasmanianSparseGrid makeGlobalGrid(int dimensions, int outputs, int depth, TypeDepth type, TypeOneDRule rule, std::vector&lt; int &gt; const &amp;anisotropic_weights=std::vector&lt; int &gt;(), double alpha=0.0, double beta=0.0, const char *custom_filename=nullptr, std::vector&lt; int &gt; const &amp;level_limits=std::vector&lt; int &gt;())</div><div class="ttdoc">Factory method, creates a new grid and calls TasmanianSparseGrid::makeGlobalGrid().</div><div class="ttdef"><b>Definition</b> TasmanianSparseGrid.hpp:2287</div></div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<!-- <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<!--  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div> -->
</body>
</html>
