<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Toolkit for Adaptive Stochastic Modeling and Non-Intrusive ApproximatioN: Tasmanian v8.1: Tasmanian Sparse Grids module, example 10</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="tasmanian.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
    <div class="doxygen">
            <a href="http://www.doxygen.org/index.html">
                Doxygen
                </a> 1.9.1
    </div>
   <div id="projectname">Toolkit for Adaptive Stochastic Modeling and Non-Intrusive ApproximatioN: Tasmanian v8.1
           <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__TasmanianSGExamples10.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Tasmanian Sparse Grids module, example 10<div class="ingroups"><a class="el" href="group__TasmanianSGExamples.html">Examples for the Tasmanian Sparse Grid module</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Tasmanian Sparse Grids module, example 10:</div>
<div class="dyncontent">
<div class="center"><img src="group__TasmanianSGExamples10.png" border="0" usemap="#agroup____TasmanianSGExamples10" alt=""/></div>
<map name="agroup____TasmanianSGExamples10" id="agroup____TasmanianSGExamples10">
<area shape="rect" href="group__TasmanianSGExamples.html" title=" " alt="" coords="5,5,193,45"/>
<area shape="rect" title=" " alt="" coords="241,5,407,45"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga0f430fa8e39dc08a67b1558fbcbebef8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TasmanianSGExamples10.html#ga0f430fa8e39dc08a67b1558fbcbebef8">sparse_grids_example_10</a> ()</td></tr>
<tr class="memdesc:ga0f430fa8e39dc08a67b1558fbcbebef8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sparse Grids Example 10: local polynomial vs. wavelet grids.  <a href="group__TasmanianSGExamples10.html#ga0f430fa8e39dc08a67b1558fbcbebef8">More...</a><br /></td></tr>
<tr class="separator:ga0f430fa8e39dc08a67b1558fbcbebef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section user"><dt>Example 10</dt><dd>Local polynomial vs. Wavelet grids. </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga0f430fa8e39dc08a67b1558fbcbebef8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0f430fa8e39dc08a67b1558fbcbebef8">&#9670;&nbsp;</a></span>sparse_grids_example_10()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sparse_grids_example_10 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sparse Grids Example 10: local polynomial vs. wavelet grids. </p>
<p>Wavelet basis has a number of desirable properties compared to the simple local polynomials, most notably, the basis coefficients are much sharper estimates of the local approximation error. In an adaptive refinement context, this often leads to a decrease in the total number of nodes. However, the wavelets also have large Lebesgue constant especially around the boundary, which can have the converse effect.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;\n---------------------------------------------------------------------------------------------------\n&quot;</span>;</div>
<div class="line">    cout &lt;&lt; std::scientific; cout.precision(4);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Example 10: comparison between local polynomial and wavelet grids\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span> num_inputs = 2;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// using random points to test the error</span></div>
<div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span> num_test_points = 1000;</div>
<div class="line">    std::vector&lt;double&gt; test_points(num_test_points * num_inputs);</div>
<div class="line">    std::minstd_rand park_miller(42);</div>
<div class="line">    std::uniform_real_distribution&lt;double&gt; domain(-1.0, 1.0);</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;t : test_points) t = domain(park_miller);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// computes the error between the gird surrogate model and the actual model</span></div>
<div class="line">    <span class="comment">// using the test points, finds the largest absolute error</span></div>
<div class="line">    <span class="keyword">auto</span> get_error = [&amp;](<a class="code" href="classTasGrid_1_1TasmanianSparseGrid.html">TasGrid::TasmanianSparseGrid</a> <span class="keyword">const</span> &amp;grid,</div>
<div class="line">                         std::function&lt;void(<span class="keywordtype">double</span> <span class="keyword">const</span> x[], <span class="keywordtype">double</span> y[], <span class="keywordtype">size_t</span>)&gt; model)-&gt;</div>
<div class="line">        <span class="keywordtype">double</span>{</div>
<div class="line">            std::vector&lt;double&gt; grid_result;</div>
<div class="line">            grid.<a class="code" href="classTasGrid_1_1TasmanianSparseGrid.html#a7e35f5abc8315c4af97b1abb7e191d85">evaluateBatch</a>(test_points, grid_result);</div>
<div class="line">            <span class="keywordtype">double</span> err = 0.0;</div>
<div class="line">            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;num_test_points; i++){</div>
<div class="line">                <span class="keywordtype">double</span> model_result; <span class="comment">// using only one output</span></div>
<div class="line">                model(&amp;test_points[i*num_inputs], &amp;model_result, 0);</div>
<div class="line">                err = std::max(err, std::abs(grid_result[i] - model_result));</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> err;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// using a model with sharp transition, the modified rules are not</span></div>
<div class="line">    <span class="comment">// suitable for this model, using rule_localp</span></div>
<div class="line">    <span class="keyword">auto</span> sharp_model = [](<span class="keywordtype">double</span> <span class="keyword">const</span> x[], <span class="keywordtype">double</span> y[], size_t)-&gt;</div>
<div class="line">        <span class="keywordtype">void</span>{ y[0] = x[0] / (1.0 + 100.0 * std::exp(-10.0 * x[1])); };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// using order 1</span></div>
<div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span> order = 1;</div>
<div class="line">    <span class="keyword">auto</span> grid_poly = <a class="code" href="group__TasmanianSG.html#gaaa84e44ca8145727564dbb57e7c939a3">TasGrid::makeLocalPolynomialGrid</a>(num_inputs, 1, 3, order,</div>
<div class="line">                                                         <a class="code" href="group__SGEnumerates.html#gga145e27d5ae92acdd5f74149c6d4f2ca2a1c5c4c912fb7bfaa5571c1db7a17646f">TasGrid::rule_localp</a>);</div>
<div class="line">    <span class="keyword">auto</span> grid_wavelet = <a class="code" href="group__TasmanianSG.html#ga39d644b025ba40d9dcfa6af96a0c7dad">TasGrid::makeWaveletGrid</a>(num_inputs, 1, 1, order);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// setup the top rows of the output table</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Using batch refinement:\n&quot;</span></div>
<div class="line">         &lt;&lt; setw(22) &lt;&lt; <span class="stringliteral">&quot;polynomial&quot;</span> &lt;&lt; setw(22) &lt;&lt; <span class="stringliteral">&quot;wavelet\n&quot;</span></div>
<div class="line">         &lt;&lt; setw(8) &lt;&lt; <span class="stringliteral">&quot;points&quot;</span> &lt;&lt; setw(14) &lt;&lt; <span class="stringliteral">&quot;error&quot;</span></div>
<div class="line">         &lt;&lt; setw(8) &lt;&lt; <span class="stringliteral">&quot;points&quot;</span> &lt;&lt; setw(14) &lt;&lt; <span class="stringliteral">&quot;error\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <span class="keyword">const</span> tolerance = 1.E-5;</div>
<div class="line">    <span class="keywordflow">while</span>((grid_poly.getNumNeeded() &gt; 0) || (grid_wavelet.getNumNeeded() &gt; 0)){</div>
<div class="line">        <a class="code" href="group__TasmanianAddonsLoadNeededVals.html#gad239942d20e99244061b4886f96dea4a">TasGrid::loadNeededValues</a>(sharp_model, grid_poly, 4);</div>
<div class="line">        <a class="code" href="group__TasmanianAddonsLoadNeededVals.html#gad239942d20e99244061b4886f96dea4a">TasGrid::loadNeededValues</a>(sharp_model, grid_wavelet, 4);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// output the grids and results at the current stage</span></div>
<div class="line">        cout &lt;&lt; setw(8) &lt;&lt; grid_poly.getNumLoaded()</div>
<div class="line">             &lt;&lt; setw(14) &lt;&lt; get_error(grid_poly, sharp_model)</div>
<div class="line">             &lt;&lt; setw(8) &lt;&lt; grid_wavelet.getNumLoaded()</div>
<div class="line">             &lt;&lt; setw(14) &lt;&lt; get_error(grid_wavelet, sharp_model) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// setting refinement for each grid</span></div>
<div class="line">        grid_poly.setSurplusRefinement(tolerance, <a class="code" href="group__SGEnumerates.html#ggac709fc494353223f300235750f8b96eda939fdaecc186a219034e156eb8ace917">TasGrid::refine_fds</a>);</div>
<div class="line">        grid_wavelet.setSurplusRefinement(tolerance, <a class="code" href="group__SGEnumerates.html#ggac709fc494353223f300235750f8b96eda939fdaecc186a219034e156eb8ace917">TasGrid::refine_fds</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Compared to local polynomial coefficients, the coefficients of the Wavelet basis</span></div>
<div class="line">    <span class="comment">// are a much sharper estimate of the local error, hence, wavelet based refinement</span></div>
<div class="line">    <span class="comment">// can result in approximation with significantly fewer nodes.</span></div>
<div class="line">    <span class="comment">// However, wavelets have larger Lebesgue constant (especially around the boundary)</span></div>
<div class="line">    <span class="comment">// and thus do not always outperform local polynomials.</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef __TASMANIAN_DOXYGEN_SKIP</span></div>
<div class="ttc" id="aclassTasGrid_1_1TasmanianSparseGrid_html"><div class="ttname"><a href="classTasGrid_1_1TasmanianSparseGrid.html">TasGrid::TasmanianSparseGrid</a></div><div class="ttdoc">The master-class that represents an instance of a Tasmanian sparse grid.</div><div class="ttdef"><b>Definition:</b> TasmanianSparseGrid.hpp:293</div></div>
<div class="ttc" id="aclassTasGrid_1_1TasmanianSparseGrid_html_a7e35f5abc8315c4af97b1abb7e191d85"><div class="ttname"><a href="classTasGrid_1_1TasmanianSparseGrid.html#a7e35f5abc8315c4af97b1abb7e191d85">TasGrid::TasmanianSparseGrid::evaluateBatch</a></div><div class="ttdeci">void evaluateBatch(std::vector&lt; FloatType &gt; const &amp;x, std::vector&lt; FloatType &gt; &amp;y) const</div><div class="ttdoc">Computes the value of the interpolant (or point-wise approximation) for a batch of points.</div></div>
<div class="ttc" id="agroup__SGEnumerates_html_gga145e27d5ae92acdd5f74149c6d4f2ca2a1c5c4c912fb7bfaa5571c1db7a17646f"><div class="ttname"><a href="group__SGEnumerates.html#gga145e27d5ae92acdd5f74149c6d4f2ca2a1c5c4c912fb7bfaa5571c1db7a17646f">TasGrid::rule_localp</a></div><div class="ttdeci">@ rule_localp</div><div class="ttdoc">Nested rule with a hierarchy of uniformly distributed nodes and functions with compact support.</div><div class="ttdef"><b>Definition:</b> tsgEnumerates.hpp:362</div></div>
<div class="ttc" id="agroup__SGEnumerates_html_ggac709fc494353223f300235750f8b96eda939fdaecc186a219034e156eb8ace917"><div class="ttname"><a href="group__SGEnumerates.html#ggac709fc494353223f300235750f8b96eda939fdaecc186a219034e156eb8ace917">TasGrid::refine_fds</a></div><div class="ttdeci">@ refine_fds</div><div class="ttdoc">Anisotropic refinement adding children only if the parents are already included.</div><div class="ttdef"><b>Definition:</b> tsgEnumerates.hpp:433</div></div>
<div class="ttc" id="agroup__TasmanianAddonsLoadNeededVals_html_gad239942d20e99244061b4886f96dea4a"><div class="ttname"><a href="group__TasmanianAddonsLoadNeededVals.html#gad239942d20e99244061b4886f96dea4a">TasGrid::loadNeededValues</a></div><div class="ttdeci">void loadNeededValues(std::function&lt; void(double const x[], double y[], size_t thread_id)&gt; model, TasmanianSparseGrid &amp;grid, size_t num_threads)</div><div class="ttdoc">Loads the current grid with model values, does not perform any refinement.</div><div class="ttdef"><b>Definition:</b> tsgLoadNeededValues.hpp:104</div></div>
<div class="ttc" id="agroup__TasmanianSG_html_ga39d644b025ba40d9dcfa6af96a0c7dad"><div class="ttname"><a href="group__TasmanianSG.html#ga39d644b025ba40d9dcfa6af96a0c7dad">TasGrid::makeWaveletGrid</a></div><div class="ttdeci">TasmanianSparseGrid makeWaveletGrid(int dimensions, int outputs, int depth, int order=1, std::vector&lt; int &gt; const &amp;level_limits=std::vector&lt; int &gt;())</div><div class="ttdoc">Factory method, creates a new grid and calls TasmanianSparseGrid::makeWaveletGrid().</div><div class="ttdef"><b>Definition:</b> TasmanianSparseGrid.hpp:2314</div></div>
<div class="ttc" id="agroup__TasmanianSG_html_gaaa84e44ca8145727564dbb57e7c939a3"><div class="ttname"><a href="group__TasmanianSG.html#gaaa84e44ca8145727564dbb57e7c939a3">TasGrid::makeLocalPolynomialGrid</a></div><div class="ttdeci">TasmanianSparseGrid makeLocalPolynomialGrid(int dimensions, int outputs, int depth, int order=1, TypeOneDRule rule=rule_localp, std::vector&lt; int &gt; const &amp;level_limits=std::vector&lt; int &gt;())</div><div class="ttdoc">Factory method, creates a new grid and calls TasmanianSparseGrid::makeLocalPolynomialGrid().</div><div class="ttdef"><b>Definition:</b> TasmanianSparseGrid.hpp:2301</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<!-- <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<!--  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div> -->
</body>
</html>
